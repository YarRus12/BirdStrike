CREATE SCHEMA IF NOT EXISTS STAGE;
CREATE SCHEMA IF NOT EXISTS DDS;
CREATE SCHEMA IF NOT EXISTS CDM;


CREATE TABLE IF NOT EXISTS STAGE.aircraft_incidents
    (indx_nr varchar(40),
    INCIDENT_DATE varchar(40),
    LATITUDE varchar(40),
    LONGITUDE varchar(40),
    AIRPORT_ID varchar(40),
    AIRPORT varchar(100),
    SPECIES varchar(200)
    );


CREATE TABLE IF NOT EXISTS STAGE.weather_observation
    (STATION varchar(40),
    DATE varchar(40),
    LATITUDE varchar(40),
    LONGITUDE varchar(40),
    ELEVATION varchar(40),
    NAME varchar(100),
    TEMP varchar(200),
    TEMP_ATTRIBUTES varchar(40),
    DEWP varchar(40),
    DEWP_ATTRIBUTES varchar(40),
    SLP varchar(40),
    SLP_ATTRIBUTES varchar(40),
    STP varchar(40),
    STP_ATTRIBUTES varchar(40),
    VISIB varchar(40),
    VISIB_ATTRIBUTES varchar(40),
    WDSP varchar(40),
    WDSP_ATTRIBUTES varchar(40),
    MXSPD varchar(40),
    GUST varchar(40),
    MAX varchar(40),
    MAX_ATTRIBUTES varchar(40),
    MIN varchar(40),
    MIN_ATTRIBUTES varchar(40),
    PRCP varchar(40),
    PRCP_ATTRIBUTES varchar(40),
    SNDP varchar(40),
    FRSHTT varchar(40)
    );


CREATE TABLE IF NOT EXISTS STAGE.top_ten_airports
(id serial,
    airport_id varchar(40),
    airport_name varchar(200),
    Year varchar(20),
    month varchar(20),
    origin_domestic varchar(20),
    origin_international varchar(20),
    origin_total varchar(20),
    destination_domestic varchar(20),
    destination_international varchar(20),
    destination_total varchar(20),
    report_dt date
    );




CREATE TABLE IF NOT EXISTS DDS.aircraft_incidents
    (indx_nr varchar(40) PRIMARY KEY,
    INCIDENT_DATE date,
    LATITUDE DOUBLE PRECISION,
    LONGITUDE DOUBLE PRECISION,
    AIRPORT_ID varchar(40),
    AIRPORT varchar(100),
    SPECIES varchar(200)
    );


CREATE TABLE IF NOT EXISTS DDS.weather_observation
    (STATION varchar(40),
    DATE date,
    LATITUDE DOUBLE PRECISION,
    LONGITUDE DOUBLE PRECISION,
    ELEVATION varchar(40),
    NAME varchar(100),
    TEMP varchar(200), -- Mean temperature (.1 Fahrenheit)
    TEMP_ATTRIBUTES varchar(40),
    DEWP varchar(40), -- Mean dew point (.1 Fahrenheit)
    DEWP_ATTRIBUTES varchar(40),
    SLP varchar(40),
    SLP_ATTRIBUTES varchar(40),
    STP varchar(40),
    STP_ATTRIBUTES varchar(40),
    VISIB varchar(40), -- Mean visibility (.1 miles)
    VISIB_ATTRIBUTES varchar(40),
    WDSP varchar(40), --WDSP – Mean wind speed (.1 knots)
    WDSP_ATTRIBUTES varchar(40),
    MXSPD varchar(40), --MXSPD - Maximum sustained wind speed (.1 knots)
    GUST varchar(40), -- Maximum wind gust (.1 knots)
    MAX varchar(40), -- Maximum temperature (.1 Fahrenheit)
    MAX_ATTRIBUTES varchar(40),
    MIN varchar(40), -- Minimum temperature (.1 Fahrenheit)
    MIN_ATTRIBUTES varchar(40),
    PRCP varchar(40), -- Precipitation amount (.01 inches)
    PRCP_ATTRIBUTES varchar(40),
    SNDP varchar(40), -- Snow depth (.1 inches)
    FRSHTT varchar(40)
    );

CREATE TABLE IF NOT EXISTS DDS.observation_station
    (id varchar(50) primary key,
    LATITUDE bigint null,
    LONGITUDE bigint null);


INSERT INTO DDS.observation_station -- заполнение id всех наблюдательных станций
(id)
values
('99999963826'),
('99999903761'),
('72405853818'),
('99999993245'),
('A0003103725'),
('74783012849'),
('72304613766'),
('99999900496'),
('99999900497'),
('72512504787'),
('99999900379'),
('99999993243'),
('72063200218'),
('74780903832'),
('72606014764'),
('72203792809'),
('74486094789'),
('74491514775'),
('72411763802'),
('72520094823'),
('72203412812'),
('72211512871'),
('72537354819'),
('99999903759'),
('99999926656'),
('72028203736'),
('99999926655'),
('72539614815'),
('72210312895'),
('72060400196'),
('72429453844'),
('99999900126'),
('99999903755'),
('99999903758'),
('74782053860'),
('72025763835'),
('72543454789'),
('99999913301'),
('72200754828'),
('72528704724'),
('72505914702'),
('72537514822'),
('72207303727'),
('99999953926'),
('72045800476'),
('72059800191'),
('99999927516'),
('72103300350'),
('99999963838'),
('72412503859'),
('72409514792'),
('72405303717'),
('72311403715'),
('72037392824'),
('72303013714'),
('72542404885'),
('72525800382'),
('99999963831'),
('72307993796'),
('72061100202'),
('72635800384'),
('72507554768'),
('74793112876'),
('99999903739'),
('91356000493'),
('72335013877'),
('72208113730'),
('72201012836'),
('72622394725'),
('72519664775'),
('72510404843'),
('99999963829'),
('72219503888'),
('99999903733'),
('99999963828'),
('99999963869'),
('72616354770'),
('72041400139'),
('99999963867'),
('99999963868'),
('72520804855'),
('72067400249'),
('72411613868'),
('72071300251'),
('99999926563'),
('99999963862'),
('99999926562'),
('74692503741'),
('74693603712'),
('72203812897'),
('72638714850'),
('72537614853'),
('99999903728'),
('72214093805'),
('72405013743'),
('99999926567'),
('99999926566'),
('72437303868'),
('72314013881'),
('99999926565'),
('99999900210'),
('99999900335'),
('74394514710'),
('99999900458'),
('99999963858'),
('72635794815'),
('99999963856'),
('99999963857'),
('72215453885'),
('99999913752'),
('99999963855'),
('99999963850'),
('72203912885'),
('72214863824'),
('72220012832'),
('72037554844'),
('99999954902'),
('99999954903'),
('72225664774'),
('72219103721'),
('72428014821'),
('74904800415'),
('99999953927'),
('72503614757'),
('72409754738'),
('74498914747'),
('74781013857'),
('72508454767'),
('99999900325'),
('99999963849'),
('72218604892'),
('72312003870'),
('99999953960'),
('72400703719'),
('72094600326'),
('99999953961'),
('99999954810'),
('72618354772'),
('99999954932'),
('99999954811'),
('99999996409'),
('99999954933'),
('72504094702'),
('99999953968'),
('99999954937'),
('72086400290'),
('99999954808'),
('99999900439'),
('72616094700'),
('99999925379'),
('72269200367'),
('99999900430'),
('72618514605'),
('72319453872'),
('72536614825'),
('72520404813'),
('72622564776'),
('72316013870'),
('74756012816'),
('72305563816'),
('99999925382'),
('72407754779'),
('99999925380'),
('99999925381'),
('72635094860'),
('72213263801'),
('72506114704'),
('72404013721'),
('72517564706'),
('99999996404'),
('99999996406'),
('72418013781'),
('99999996405'),
('72204992805'),
('99999996408'),
('A0688400416'),
('99999996407'),
('72314863859'),
('74594693786'),
('72310700371'),
('72063100217'),
('72212312809'),
('99999900425'),
('72202912888'),
('99999953182'),
('72059300187'),
('72028803711'),
('72535404806'),
('72619614610'),
('72401693736'),
('72538794899'),
('99999925711'),
('72521404849'),
('72073800267'),
('72060300195'),
('72636404883'),
('74598563806'),
('72501454780'),
('72622894740'),
('72504514758'),
('72061200203'),
('72037154850'),
('72473700377'),
('72038400124'),
('72307403703'),
('72217653884'),
('74793012843'),
('78961300410'),
('99999973801'),
('99999973802'),
('72541554821'),
('99999973803'),
('72410753895'),
('72515614748'),
('72314653892'),
('72060100193'),
('72094400324'),
('91212041415'),
('72605014745'),
('72311913886'),
('72224303738'),
('72213713878'),
('74787012834'),
('72412753801'),
('72628494836'),
('74791800391'),
('72438453842'),
('78982000411'),
('72028963836'),
('72743604863'),
('72034054818'),
('72743554820'),
('72538354827'),
('72224754785'),
('72419003889'),
('72218992815'),
('72104200486'),
('72502014734'),
('72054500169'),
('72539014836'),
('72317763807'),
('72536094830'),
('72210492806'),
('99999993733'),
('72637914845'),
('72427514894'),
('72027493799'),
('72423353841'),
('72417613736'),
('72362603737'),
('72438504828'),
('72522404852'),
('72311553854'),
('72219013874'),
('A0708600468'),
('72027763843'),
('72405663805'),
('72324013882'),
('72437503893'),
('72743404870'),
('99999925630'),
('72540704854'),
('72713594623'),
('72525404851'),
('72039200128'),
('72211912883'),
('72212853899'),
('72505394728'),
('72217003813'),
('99999923583'),
('72202192816'),
('72611454771'),
('72638414817'),
('72216013869'),
('99999922016'),
('72435653866'),
('72428704848'),
('72537094847'),
('99999994644'),
('99999925522'),
('99999994645'),
('72541854823'),
('72037492825'),
('72090200298'),
('72608304836'),
('72741754825'),
('72067100248'),
('99999904990'),
('72520754735'),
('99999994995'),
('72521753855'),
('99999994996'),
('72214504884'),
('99999904994'),
('72215653873'),
('74791593718'),
('72326013891'),
('72073600265'),
('72310613744'),
('72096200337'),
('91221041419'),
('72316563821'),
('74780563818'),
('91233341420'),
('72218003820'),
('72210612835'),
('72310993782'),
('72403303706'),
('72058100178'),
('72219863819'),
('99999992828'),
('99999954794'),
('99999992827'),
('99999954795'),
('99999992826'),
('99999954796'),
('99999954797'),
('78551011624'),
('72201612896'),
('72218553838'),
('72210900355'),
('72412003872'),
('72060200194'),
('72039700131'),
('72205312841'),
('72312263889'),
('72551403757'),
('72219753819'),
('72306513783'),
('72216703718'),
('72508714752'),
('99999921514'),
('99999921515'),
('72057500173'),
('72529400383'),
('99999903072'),
('72303593740'),
('99999903074'),
('72226100360'),
('72060800200'),
('72425003860'),
('72061300204'),
('72507914787'),
('72213013861'),
('72206603853'),
('99999992821'),
('72406793744'),
('72533694895'),
('78543011640'),
('72213653883'),
('99999903062'),
('72074400271'),
('99999903063'),
('72320093801'),
('72028404877'),
('72537494889'),
('72607014606'),
('99999903067'),
('72032464753'),
('72506694724'),
('99999903060'),
('74791700390'),
('72503014732'),
('72214753817'),
('72060600198'),
('72403093738'),
('72429793812'),
('72202012839'),
('72302013748'),
('74466000388'),
('99999904140'),
('72050100155'),
('72506854777'),
('99999904141'),
('99999903055'),
('72205712854'),
('99999903054'),
('72406693706'),
('72309893798'),
('72069903724'),
('72508554756'),
('72062900216'),
('72508014740'),
('72502754788'),
('A0735900240'),
('72044800144'),
('72035503732'),
('72306893759'),
('72202412882'),
('72616454728'),
('72538694898'),
('72540554816'),
('72614594705'),
('99999904131'),
('72635594871'),
('72041500140'),
('99999904130'),
('72210812894'),
('74207703763'),
('72502964707'),
('72411893797'),
('72206763823'),
('78535011630'),
('72541614864'),
('72035363875'),
('72071400252'),
('72027803704'),
('72096600339'),
('72065500235'),
('99999953149'),
('99999904137'),
('72219303722'),
('99999903048'),
('72541404886'),
('99999903047'),
('99999904136'),
('99999904139'),
('99999904138'),
('72103500352'),
('72502594741'),
('99999956401'),
('A0680000120'),
('72540654817'),
('72201512850'),
('72420014891'),
('72525604857'),
('74693503709'),
('72090300441'),
('99999953138'),
('99999904126'),
('99999904125'),
('72511654737'),
('99999953136'),
('99999904128'),
('99999904127'),
('72221800356'),
('72427653859'),
('99999953132'),
('74486454787'),
('72090400299'),
('72404303756'),
('99999953131'),
('72540404847'),
('72540904882'),
('72060500197'),
('72411353881'),
('91232041418'),
('72207003822'),
('72405503714'),
('72611694765'),
('72614054742'),
('99999904236'),
('72092800315'),
('72512614736'),
('99999904237'),
('72537804887'),
('72215114794'),
('99999953151'),
('99999953150'),
('74207864773'),
('72511493778'),
('99999904223'),
('99999904222'),
('72410613728'),
('72212504829'),
('72506454769'),
('99999993804'),
('74421494852'),
('72605654791'),
('72060900201'),
('72506594726'),
('72510514770'),
('72034863886'),
('72026853882'),
('72027903705'),
('72234654824'),
('99999953155'),
('99999953154'),
('72401703707'),
('72639404874'),
('99999953152'),
('78526011641'),
('72234354826'),
('99999964758'),
('72526604751'),
('99999964756'),
('72506014756'),
('99999964757'),
('72538404888'),
('72205012815'),
('72410593760'),
('72096100336'),
('99999994059'),
('72030464752'),
('72421093814'),
('72049354758'),
('72206263842'),
('99999912987'),
('99999963898'),
('72401493714'),
('99999963899'),
('99999963896'),
('99999963897'),
('A0003093795'),
('99999953974'),
('99999963894'),
('72211012842'),
('99999963892'),
('72524504853'),
('99999963893'),
('99999926494'),
('72510704780'),
('99999963891'),
('72269100366'),
('72428693824'),
('72306793726'),
('72301003810'),
('78520300398'),
('72539404839'),
('72429804850'),
('72508654734'),
('72519454778'),
('99999954854'),
('74694003708'),
('72541754822'),
('72049200151'),
('72201412818'),
('72506994624'),
('99999954856'),
('72059700190'),
('72217763811'),
('72213103713'),
('72526014860'),
('72027504872'),
('72310453867'),
('72314453890'),
('72031703735'),
('72417713734'),
('99999953877'),
('99999953878'),
('72032104893'),
('72423513810'),
('72207953888'),
('72540804881'),
('72400603701'),
('72211800482'),
('72637594817'),
('74780663809'),
('72011354829'),
('72744014858'),
('72518014735'),
('72512854739'),
('91246041606'),
('72507014765'),
('72639514808'),
('72028503734'),
('72094800328'),
('72049400152'),
('72522014750'),
('72520514762'),
('72032863832'),
('72637014826'),
('72030163846'),
('72528300465'),
('72525014852'),
('72071200250'),
('72524704805'),
('99999994081'),
('72060700199'),
('99999994082'),
('72067200485'),
('72524014820'),
('72508854733'),
('72221312819'),
('A0677300334'),
('99999923904'),
('99999994084'),
('99999923907'),
('99999994085'),
('72411593757'),
('99999923906'),
('72308313763'),
('99999994088'),
('72521014895'),
('72417503802'),
('99999923909'),
('99999923908'),
('72026654809'),
('72040800136'),
('72063400220'),
('72427303804'),
('72435463815'),
('72224400358'),
('74692903702'),
('91408040310'),
('72525300380'),
('99999994074'),
('99999994075'),
('72213463822'),
('78367011706'),
('99999994077'),
('72409454743'),
('99999994078'),
('99999994079'),
('72204012838'),
('72203012844'),
('72517014737'),
('72424303849'),
('72045600146'),
('78958000409'),
('99999994060'),
('72515004725'),
('72428463825'),
('72220103723'),
('72218113837'),
('72214103731'),
('72509854704'),
('78970011634'),
('72315663812'),
('72064900231'),
('72428804804'),
('72221763881'),
('99999923801'),
('72703314609'),
('74486514719'),
('72012063837'),
('99999923803');


CREATE TABLE IF NOT EXISTS DDS.airport_bts_name
    (id varchar(50) primary key,
    bts_name varchar null);

INSERT INTO DDS.airport_bts_name -- заполнение id всех наблюдательных станций
(id, bts_name)
values
('KDEN', '- DENVER, CO: Denver international'),
('KDFW', '- DALLAS/FORT WORTH'),
('KORD', '- CHICAGO, IL: CHICAGO OHARE'),
('KATL', '- Atlanta, GA: Hartsfield-Jackson Atlanta international'),
('KDTW', '- DETROIT, ML: DETROIT METRO WAYNE COUNTY'),
('KMEM', '- MEMPHIS, TN: MEMPHIS international'),
('KJFK', '- New York, NY: John F. Kennedy International'),
('KMCO', '- Orlando, FL: Orlando International'),
('KCLT', '- CHARLOTTE, NC: Charlotte/Douglas International'),
('KSLC', '- Salt Lake City, UT: Salt Lake City International');


CREATE TABLE IF NOT EXISTS STAGE.top_ten_airports
(id serial primary key,
    airport_id varchar(40),
    airport_name varchar(200),
    Year int,
    month int,
    origin_domestic float,
    origin_international float,
    origin_total float,
    destination_domestic float,
    destination_international float,
    destination_total float
    );